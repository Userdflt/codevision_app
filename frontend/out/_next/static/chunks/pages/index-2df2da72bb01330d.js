(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{65568:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var a=t(37876),r=t(14232),n=t(77328),i=t.n(n),l=t(30510),o=t(99764),c=t(5378),d=t(54550);function m(e){let{user:s,onSignOut:t}=e;return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Code Vision"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"AI Building Code Assistant"})]}),s&&(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(l.W1,{as:"div",className:"relative",children:[(0,a.jsxs)(l.W1.Button,{className:"flex items-center text-sm text-gray-700 hover:text-gray-900",children:[(0,a.jsx)(c.A,{className:"h-8 w-8 mr-2"}),(0,a.jsx)("span",{className:"hidden md:block",children:s.email}),(0,a.jsx)(d.A,{className:"h-4 w-4 ml-1"})]}),(0,a.jsx)(o.e,{as:r.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,a.jsx)(l.W1.Items,{className:"absolute right-0 mt-2 w-48 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:(0,a.jsx)("div",{className:"py-1",children:(0,a.jsx)(l.W1.Item,{children:e=>{let{active:s}=e;return(0,a.jsx)("button",{onClick:t,className:"".concat(s?"bg-gray-100":""," block w-full text-left px-4 py-2 text-sm text-gray-700"),children:"Sign Out"})}})})})})]})})]})})})}function u(e){let{children:s,user:t,onSignOut:r}=e;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(m,{user:t,onSignOut:r}),(0,a.jsx)("main",{className:"container mx-auto px-4 py-8",children:s})]})}var x=t(50965),h=t(57186),g=t(39180),p=t(87979),f=t(49086),y=t(80825);function j(){return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Thinking..."})]})}function b(e){let{source:s}=e,{metadata:t}=s;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-3 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:t.section||t.clause_type||"Building Code Reference"}),(0,a.jsxs)("div",{className:"text-gray-500",children:[Math.round(100*s.similarity_score),"% match"]})]}),(0,a.jsxs)("p",{className:"text-gray-700 mb-2 line-clamp-3",children:[s.content.substring(0,150),s.content.length>150&&"..."]}),(0,a.jsxs)("div",{className:"flex justify-between text-gray-500",children:[t.source&&(0,a.jsx)("span",{children:t.source}),t.page_number&&(0,a.jsxs)("span",{children:["Page ",t.page_number]})]})]})}function v(e){let{messages:s,isLoading:t}=e,n=(0,r.useRef)(null);return((0,r.useEffect)(()=>{var e;null==(e=n.current)||e.scrollIntoView({behavior:"smooth"})},[s,t]),0!==s.length||t)?(0,a.jsxs)("div",{className:"h-full overflow-y-auto p-4 space-y-4",children:[s.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[80%] rounded-lg px-4 py-3 ".concat("user"===e.role?"bg-primary-600 text-white":e.isError?"bg-red-50 border border-red-200 text-red-700":"bg-gray-50 border border-gray-200 text-gray-900"),children:["user"===e.role?(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.content}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,a.jsx)(g.oz,{remarkPlugins:[p.A],components:{code(e){let{node:s,inline:t,className:r,children:n,...i}=e,l=/language-(\w+)/.exec(r||"");return!t&&l?(0,a.jsx)(f.A,{style:y.bM,language:l[1],PreTag:"div",className:"rounded-md",...i,children:String(n).replace(/\n$/,"")}):(0,a.jsx)("code",{className:r,...i,children:n})}},children:e.content})}),e.agentUsed&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Answered by: ",e.agentUsed.replace("_"," ").toUpperCase()]})}),e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-2 font-medium",children:"Sources:"}),(0,a.jsx)("div",{className:"space-y-2",children:e.sources.slice(0,3).map((e,s)=>(0,a.jsx)(b,{source:e},s))})]})]}),(0,a.jsx)("p",{className:"text-xs mt-2 ".concat("user"===e.role?"text-primary-100":"text-gray-500"),children:e.timestamp.toLocaleTimeString()})]})},e.id)),t&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg px-4 py-3",children:(0,a.jsx)(j,{})})}),(0,a.jsx)("div",{ref:n})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg mb-2",children:"Welcome to Code Vision!"}),(0,a.jsx)("p",{className:"text-sm",children:"Ask me anything about Australian building codes and regulations."}),(0,a.jsxs)("div",{className:"mt-4 text-xs space-y-1",children:[(0,a.jsx)("p",{children:"Try asking:"}),(0,a.jsx)("p",{className:"italic",children:'"What is the minimum R-value for Zone 3 walls?"'}),(0,a.jsx)("p",{className:"italic",children:'"What are the fire egress requirements for Class 2 buildings?"'})]})]})})}async function N(e,s){let t={"Content-Type":"application/json"};s&&(t.Authorization="Bearer ".concat(s));let a=await fetch("".concat("http://localhost:8000","/api/v1/chat"),{method:"POST",headers:t,body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"HTTP error! status: ".concat(a.status));return a.json()}function w(e){let{userId:s}=e,[t,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),[d]=(0,r.useState)(()=>(0,h.A)()),m=(0,r.useRef)(null),u=async e=>{if(e.preventDefault(),!i.trim()||o)return;let s={id:(0,h.A)(),content:i.trim(),role:"user",timestamp:new Date};n(e=>[...e,s]),l(""),c(!0);try{let e=await N({content:s.content,session_id:d}),t={id:(0,h.A)(),content:e.response,role:"assistant",timestamp:new Date,sources:e.sources,agentUsed:e.agent_used};n(e=>[...e,t])}catch(s){console.error("Chat error:",s);let e={id:(0,h.A)(),content:"I apologize, but I encountered an error processing your request. Please try again.",role:"assistant",timestamp:new Date,isError:!0};n(s=>[...s,e])}finally{c(!1)}};return(0,r.useEffect)(()=>{m.current&&m.current.focus()},[o]),(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 h-[600px] flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Building Code Assistant"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Ask questions about Australian building codes and regulations"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(v,{messages:t,isLoading:o})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200",children:[(0,a.jsxs)("form",{onSubmit:u,className:"flex gap-2",children:[(0,a.jsx)("textarea",{ref:m,value:i,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u(e))},placeholder:"Ask about building codes, regulations, or requirements...",className:"flex-1 resize-none rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:2,disabled:o}),(0,a.jsx)("button",{type:"submit",disabled:!i.trim()||o,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:(0,a.jsx)(x.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:"Press Enter to send, Shift+Enter for new line"})]})]})})}var S=t(1663),k=t(56372),C=t(51292);function A(e){let{isOpen:s,onClose:t}=e,[n,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(""),{supabase:p}=(0,C.useSupabase)(),f=async e=>{e.preventDefault(),x(!0),g("");try{if(d){let{error:e}=await p.auth.signUp({email:n,password:l});if(e)throw e;g("Check your email for the confirmation link!")}else{let{error:e}=await p.auth.signInWithPassword({email:n,password:l});if(e)throw e;t()}}catch(e){g(e.message)}finally{x(!1)}},y=async()=>{try{let{error:e}=await p.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(e)throw e}catch(e){g(e.message)}};return(0,a.jsx)(o.e,{appear:!0,show:s,as:r.Fragment,children:(0,a.jsxs)(S.lG,{as:"div",className:"relative z-10",onClose:t,children:[(0,a.jsx)(o.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(o.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(S.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(S.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:d?"Create Account":"Sign In"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(k.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",value:n,onChange:e=>i(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsx)("input",{type:"password",id:"password",value:l,onChange:e=>c(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500",required:!0,minLength:6})]}),h&&(0,a.jsx)("div",{className:"text-sm ".concat(h.includes("Check your email")?"text-green-600":"text-red-600"),children:h}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:u?"Loading...":d?"Sign Up":"Sign In"})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,a.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or"})})]}),(0,a.jsx)("button",{onClick:y,className:"mt-4 w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Continue with Google"})]}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("button",{onClick:()=>m(!d),className:"text-sm text-primary-600 hover:text-primary-500",children:d?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})})})]})})}function _(){let{supabase:e}=(0,C.useSupabase)(),[s,t]=(0,r.useState)(null),[n,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e.auth.getSession().then(e=>{let{data:{session:s}}=e;t(s)});let{data:{subscription:s}}=e.auth.onAuthStateChange((e,s)=>{t(s)});return()=>s.unsubscribe()},[e]),(0,r.useEffect)(()=>{s||l(!0)},[s]);let o=async()=>{await e.auth.signOut()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"Code Vision - AI Building Code Assistant"}),(0,a.jsx)("meta",{name:"description",content:"AI-powered assistant for Australian building codes and regulations"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:""}),(0,a.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"})]}),(0,a.jsx)(u,{user:null==s?void 0:s.user,onSignOut:o,children:s?(0,a.jsx)(w,{userId:s.user.id}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Welcome to Code Vision"}),(0,a.jsx)("p",{className:"text-gray-600 mb-8",children:"Your AI-powered assistant for Australian building codes and regulations"}),(0,a.jsx)("button",{onClick:()=>l(!0),className:"bg-primary-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-primary-700 transition-colors",children:"Sign In to Get Started"})]})})}),(0,a.jsx)(A,{isOpen:n,onClose:()=>l(!1)})]})}},82898:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(65568)}])}},e=>{e.O(0,[701,635,636,593,792],()=>e(e.s=82898)),_N_E=e.O()}]);